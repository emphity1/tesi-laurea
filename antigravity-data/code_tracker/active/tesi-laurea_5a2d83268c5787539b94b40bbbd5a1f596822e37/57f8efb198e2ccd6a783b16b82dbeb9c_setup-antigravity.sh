Â#!/bin/bash
# Script per configurare Antigravity ad ogni avvio del pod
# Salva TUTTO lo stato di Antigravity (logs, brain, knowledge, ecc.)

PERSISTENT_DIR="/workspace/tesi-laurea/antigravity-data"

echo "ğŸ”§ Configurazione Antigravity..."

# 1. Se la directory persistente non esiste (prima esecuzione), inizializzala
if [ ! -d "$PERSISTENT_DIR" ]; then
    echo "Inizializzazione storage persistente in $PERSISTENT_DIR..."
    mkdir -p "$PERSISTENT_DIR"
    
    # Copia i log delle conversazioni (CRUCIALE per la cronologia)
    if [ -d "/root/.gemini/antigravity/conversations" ]; then
        cp -r /root/.gemini/antigravity/conversations "$PERSISTENT_DIR/"
    fi
    
    # Gestione brain (media files)
    # Se brain Ã¨ giÃ  un symlink alla vecchia location, copiamo da lÃ¬
    if [ -L "/root/.gemini/antigravity/brain" ]; then
        if [ -d "/workspace/tesi-laurea/antigravity-conversations" ]; then
            echo "Migrazione vecchi media..."
            cp -r /workspace/tesi-laurea/antigravity-conversations "$PERSISTENT_DIR/brain"
        fi
    elif [ -d "/root/.gemini/antigravity/brain" ]; then
        cp -r /root/.gemini/antigravity/brain "$PERSISTENT_DIR/"
    fi

    # Copia altre directory importanti se esistono
    for dir in knowledge annotations code_tracker context_state implicit; do
        if [ -d "/root/.gemini/antigravity/$dir" ]; then
            cp -r "/root/.gemini/antigravity/$dir" "$PERSISTENT_DIR/"
        fi
    done
    
    # Copia file sparsi
    cp /root/.gemini/antigravity/*.json "$PERSISTENT_DIR/" 2>/dev/null || true
    cp /root/.gemini/antigravity/installation_id "$PERSISTENT_DIR/" 2>/dev/null || true
fi

# 2. Configura il symlink all'avvio
# Se /root/.gemini/antigravity esiste ma NON Ã¨ un symlink alla nostra dir persistente
if [ ! -L "/root/.gemini/antigravity" ] || [ "$(readlink /root/.gemini/antigravity)" != "$PERSISTENT_DIR" ]; then
    echo "Collegamento alla memoria persistente..."
    
    # Rimuovi la directory di default (o il vecchio symlink errato) e sostituiscila
    rm -rf /root/.gemini/antigravity
    ln -s "$PERSISTENT_DIR" /root/.gemini/antigravity
fi

echo "âœ… Antigravity configurato! Tutto lo stato (inclusi i log) Ã¨ ora persistente in $PERSISTENT_DIR"
I ILLM MNNO OTTU UVVX XZZ[ [\\^ ^__` `bbc cdde effh hllm mnnp puuy yzz{ {…
…† †
§ §Å
Åô ôø
ø‡ ‡ˆ
ˆ‰ ‰‘
‘“ “”
”– –œ
œ  
 ¡ ¡£
£¤ ¤ª
ª® ®²
²³ ³Â
ÂÃ Ãá
áâ âä
äå åï
ïğ ğû
ûı ış
şÿ ÿ…
…† †Š
Š ©
©ª ª®
®· ·İ
İŞ Şë
ëí íş
şÿ ÿƒ
ƒ„ „…
…† †¦
¦§ §«
«¬ ¬®
®¯ ¯¼
¼½ ½¾
¾¿ ¿Á
ÁÂ ÂÚ
ÚÜ Üå
åæ æê
êö ö÷
÷„ „—
—˜ ˜
Ÿ Ÿ¨
¨ª ª®
®° °²
²³ ³µ
µ¶ ¶¸
¸¹ ¹¼
¼¾ ¾Î
ÎÏ ÏÑ
ÑÒ ÒØ
ØÙ ÙÚ
ÚÛ Ûİ
İß ßà
àâ âí
íî îï
ïğ ğó
óô ôú
úû û
 “
“™ ™š
š¾ ¾¿
¿À ÀÇ
ÇÉ ÉÑ
ÑÓ ÓÔ
Ô× ×Ø
ØÙ Ùá
áã ãä
äå åì
ìø øş
şÿ ÿ€
€ ‚
‚ƒ ƒ„
„… …†
† ˜
˜¢ ¢£
£¤ ¤©
©ª ª­
­® ®³
³´ ´¸
¸¹ ¹Å
ÅÆ ÆŞ
Şß ßã
ãå åó
óô ôû
ûü üı
ış ş“
“” ”›
›œ œ¢
¢£ £¦
¦§ §°
°± ±»
»¼ ¼Á
ÁÂ ÂÃ
ÃÄ ÄÒ
ÒÓ ÓÛ
Ûà àæ
æ‰	 ‰	œ	
œ		 	¡	
¡	¥	 ¥	©	
©	¬	 ¬	¯	
¯	±	 ±	²	
²	³	 ³	Ç	
Ç	È	 È	Ë	
Ë	Ì	 Ì	Ò	
Ò	Ô	 Ô	Ş	
Ş	ß	 ß	õ	
õ	ö	 ö	÷	
÷	ø	 ø	ƒ

ƒ
…
 …
‰

‰
Š
 Š
–

–
—
 —
›

›
œ
 œ
¡

¡
£
 £
­

­
®
 ®
·

·
¸
 ¸
¾

¾
¿
 ¿
ê

ê
ë
 ë
õ

õ
ö
 ö
„
„… …‰
‰Š Š
‘ ‘§
§¨ ¨µ
µ· ·Ì
ÌÍ ÍÎ
ÎÏ ÏÒ
ÒÓ Óê
êë ëï
ïğ ğò
òó óú
úû û“
“” ” 
 ¡ ¡¥
¥¦ ¦©
©Ä Äş
ş „
„† †Œ
Œ™ ™ú
úŸ Ÿ´
´¶ ¶¾
¾À Àã
ãø øû
ûü ü‚
‚„ „…
…† †ˆ
ˆ‰ ‰Š
Š‹ ‹
 
‘ ‘’
’– –™
™š šœ
œ¥ ¥´
´µ µ¶
¶· ·½
½¿ ¿Ç
ÇÈ ÈÔ
ÔÕ Õâ
âã ãæ
æç çê
êë ëì
ìí íğ
ğñ ñ÷
÷ù ù†
†‡ ‡
 ’
’ ¦
¦¨ ¨º
ºü ü
‚ ‚ƒ
ƒ„ „…
…† †‡
‡ˆ ˆŒ
Œ ’
’” ”•
•— —š
š› ›
¡ ¡£
£¤ ¤¥
¥§ §©
©­ ­®
®° °À
ÀÂ "(5a2d83268c5787539b94b40bbbd5a1f596822e3722file:///workspace/tesi-laurea/setup-antigravity.sh:file:///workspace/tesi-laurea